{{- if .Values.clusterSecretStore.enabled }}
apiVersion: external-secrets.io/v1
kind: ClusterSecretStore
metadata:
  name: {{ .Values.clusterSecretStore.name }}
  labels:
    app.kubernetes.io/managed-by: Helm
spec:
  provider:
    infisical:
      siteUrl: {{ .Values.clusterSecretStore.infisicalUrl | quote }}
      auth:
        universalAuthCredentials:
          clientId:
            secretRef:
              name: {{ .Values.clusterSecretStore.secretRef.name }}
              namespace: {{ .Values.clusterSecretStore.secretRef.namespace | default "external-secrets" }}
              key: {{ .Values.clusterSecretStore.secretRef.clientIdKey | default "clientId" }}
          clientSecret:
            secretRef:
              name: {{ .Values.clusterSecretStore.secretRef.name }}
              namespace: {{ .Values.clusterSecretStore.secretRef.namespace | default "external-secrets" }}
              key: {{ .Values.clusterSecretStore.secretRef.clientSecretKey | default "clientSecret" }}
{{- end }}
