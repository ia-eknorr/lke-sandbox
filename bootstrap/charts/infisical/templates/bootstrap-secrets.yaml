{{/*
Bootstrap secrets for provision-eso job to upload to Infisical
Sourced from local files via helmfile readFile
*/}}
{{- if .Values.bootstrapSecrets.cloudflareApiToken }}
apiVersion: v1
kind: Secret
metadata:
  name: infisical-bootstrap-secrets
  namespace: {{ .Release.Namespace }}
  annotations:
    helm.sh/hook: post-install
    helm.sh/hook-weight: "14"  # Before provision-eso job (15)
    helm.sh/hook-delete-policy: hook-succeeded
type: Opaque
stringData:
  cloudflare-api-token: {{ .Values.bootstrapSecrets.cloudflareApiToken | quote }}
{{- end }}
